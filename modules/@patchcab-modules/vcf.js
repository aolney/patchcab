import{Faceplate as t,Knob as n,Patch as e,Switch as _}from"https://olney.ai/patchcab/js/core.js";function s(t){let s,o,r,i,v,p,$,u,l,m,f,d,y,g,q,b,h,x;function w(n){t[4](n)}let k={label:"frequency",x:20,y:60,min:a,max:c};function C(n){t[5](n)}void 0!==t[0].freq&&(k.value=t[0].freq),s=new n({props:k}),__sv.binding_callbacks.push((()=>__sv.bind(s,"value",w)));let j={size:"s",label:"fm",x:27,y:150,min:.01,max:1,precision:2};function F(n){t[6](n)}void 0!==t[0].cv&&(j.value=t[0].cv),i=new n({props:j}),__sv.binding_callbacks.push((()=>__sv.bind(i,"value",C))),$=new e({props:{label:"cv",x:20,y:220,name:"cv-in",input:t[2],onConnect:t[3]}});let M={x:20,y:270,label:"low",set:"lowpass"};function S(n){t[7](n)}void 0!==t[0].type&&(M.value=t[0].type),l=new _({props:M}),__sv.binding_callbacks.push((()=>__sv.bind(l,"value",F)));let T={x:60,y:270,label:"high",set:"highpass"};return void 0!==t[0].type&&(T.value=t[0].type),d=new _({props:T}),__sv.binding_callbacks.push((()=>__sv.bind(d,"value",S))),q=new e({props:{label:"in",x:20,y:320,name:"audio-in",input:t[1]}}),h=new e({props:{label:"out",x:60,y:320,name:"audio-out",output:t[1]}}),{c(){__sv.create_component(s.$$.fragment),r=__sv.space(),__sv.create_component(i.$$.fragment),p=__sv.space(),__sv.create_component($.$$.fragment),u=__sv.space(),__sv.create_component(l.$$.fragment),f=__sv.space(),__sv.create_component(d.$$.fragment),g=__sv.space(),__sv.create_component(q.$$.fragment),b=__sv.space(),__sv.create_component(h.$$.fragment)},m(t,n){__sv.mount_component(s,t,n),__sv.insert(t,r,n),__sv.mount_component(i,t,n),__sv.insert(t,p,n),__sv.mount_component($,t,n),__sv.insert(t,u,n),__sv.mount_component(l,t,n),__sv.insert(t,f,n),__sv.mount_component(d,t,n),__sv.insert(t,g,n),__sv.mount_component(q,t,n),__sv.insert(t,b,n),__sv.mount_component(h,t,n),x=!0},p(t,n){const e={};!o&&1&n&&(o=!0,e.value=t[0].freq,__sv.add_flush_callback((()=>o=!1))),s.$set(e);const _={};!v&&1&n&&(v=!0,_.value=t[0].cv,__sv.add_flush_callback((()=>v=!1))),i.$set(_);const a={};4&n&&(a.input=t[2]),$.$set(a);const c={};!m&&1&n&&(m=!0,c.value=t[0].type,__sv.add_flush_callback((()=>m=!1))),l.$set(c);const r={};!y&&1&n&&(y=!0,r.value=t[0].type,__sv.add_flush_callback((()=>y=!1))),d.$set(r);const p={};2&n&&(p.input=t[1]),q.$set(p);const u={};2&n&&(u.output=t[1]),h.$set(u)},i(t){x||(__sv.transition_in(s.$$.fragment,t),__sv.transition_in(i.$$.fragment,t),__sv.transition_in($.$$.fragment,t),__sv.transition_in(l.$$.fragment,t),__sv.transition_in(d.$$.fragment,t),__sv.transition_in(q.$$.fragment,t),__sv.transition_in(h.$$.fragment,t),x=!0)},o(t){__sv.transition_out(s.$$.fragment,t),__sv.transition_out(i.$$.fragment,t),__sv.transition_out($.$$.fragment,t),__sv.transition_out(l.$$.fragment,t),__sv.transition_out(d.$$.fragment,t),__sv.transition_out(q.$$.fragment,t),__sv.transition_out(h.$$.fragment,t),x=!1},d(t){__sv.destroy_component(s,t),t&&__sv.detach(r),__sv.destroy_component(i,t),t&&__sv.detach(p),__sv.destroy_component($,t),t&&__sv.detach(u),__sv.destroy_component(l,t),t&&__sv.detach(f),__sv.destroy_component(d,t),t&&__sv.detach(g),__sv.destroy_component(q,t),t&&__sv.detach(b),__sv.destroy_component(h,t)}}}function o(n){let e,_;return e=new t({props:{title:"VCF",color:"var(--color-1)",light:!0,$$slots:{default:[s]},$$scope:{ctx:n}}}),{c(){__sv.create_component(e.$$.fragment)},m(t,n){__sv.mount_component(e,t,n),_=!0},p(t,[n]){const _={};263&n&&(_.$$scope={dirty:n,ctx:t}),e.$set(_)},i(t){_||(__sv.transition_in(e.$$.fragment,t),_=!0)},o(t){__sv.transition_out(e.$$.fragment,t),_=!1},d(t){__sv.destroy_component(e,t)}}}const a=20,c=800;function r(t,n,e){let{state:_={freq:440,type:"lowpass",cv:1}}=n;const s=new Tone.Filter(_.freq,_.type),o=new Tone.Scale(a,c);return t.$$set=t=>{"state"in t&&e(0,_=t.state)},t.$$.update=()=>{1&t.$$.dirty&&e(1,s.frequency.value=_.freq,s),1&t.$$.dirty&&e(1,s.type=_.type,s),1&t.$$.dirty&&e(2,o.min=Math.max(a,_.freq-_.freq*_.cv),o),1&t.$$.dirty&&e(2,o.max=Math.min(c,_.freq+(c-_.freq)*_.cv),o)},[_,s,o,t=>{t?o.connect(s.frequency):(o.disconnect(s.frequency),e(1,s.frequency.overridden=!1,s),e(1,s.frequency.value=_.freq,s))},function(n){t.$$.not_equal(_.freq,n)&&(_.freq=n,e(0,_))},function(n){t.$$.not_equal(_.cv,n)&&(_.cv=n,e(0,_))},function(n){t.$$.not_equal(_.type,n)&&(_.type=n,e(0,_))},function(n){t.$$.not_equal(_.type,n)&&(_.type=n,e(0,_))}]}class i extends __sv.SvelteComponent{constructor(t){super(),__sv.init(this,t,r,o,__sv.safe_not_equal,{state:0})}}export{i as default};
