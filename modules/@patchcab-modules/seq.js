import{Faceplate as t,Bang as n,Patch as e,Switch as o}from"/js/core.js";function _(t){__sv.append_styles(t,"svelte-zmh6p6","steps.svelte-zmh6p6{position:absolute;left:20px;display:grid;grid-template-columns:repeat(16, 1fr);grid-template-rows:1fr;grid-column-gap:10px;width:calc(100% - 40px);height:20px;margin-bottom:8px}")}function s(t,n,e){const o=t.slice();return o[7]=n[e],o[9]=e,o}function r(t,n,e){const o=t.slice();return o[10]=n[e],o[12]=e,o}function i(t,n,e){const o=t.slice();return o[13]=n[e],o[15]=e,o}function l(t){let n,e;return n=new o({props:{x:28*t[15],y:0,value:1===t[13],high:t[1]===t[15]+1,square:!0,onToggle:function(){return t[6](t[12],t[15])}}}),{c(){__sv.create_component(n.$$.fragment)},m(t,o){__sv.mount_component(n,t,o),e=!0},p(e,o){t=e;const _={};1&o&&(_.value=1===t[13]),2&o&&(_.high=t[1]===t[15]+1),n.$set(_)},i(t){e||(__sv.transition_in(n.$$.fragment,t),e=!0)},o(t){__sv.transition_out(n.$$.fragment,t),e=!1},d(t){__sv.destroy_component(n,t)}}}function a(t){let n,e,o=t[10],_=[];for(let n=0;n<o.length;n+=1)_[n]=l(i(t,o,n));const s=t=>__sv.transition_out(_[t],1,1,(()=>{_[t]=null}));return{c(){n=__sv.element("steps");for(let t=0;t<_.length;t+=1)_[t].c();__sv.set_style(n,"top",70+40*t[12]+"px"),__sv.attr(n,"class","svelte-zmh6p6")},m(t,o){__sv.insert(t,n,o);for(let t=0;t<_.length;t+=1)_[t].m(n,null);e=!0},p(t,e){if(7&e){let r;for(o=t[10],r=0;r<o.length;r+=1){const s=i(t,o,r);_[r]?(_[r].p(s,e),__sv.transition_in(_[r],1)):(_[r]=l(s),_[r].c(),__sv.transition_in(_[r],1),_[r].m(n,null))}for(__sv.group_outros(),r=o.length;r<_.length;r+=1)s(r);__sv.check_outros()}},i(t){if(!e){for(let t=0;t<o.length;t+=1)__sv.transition_in(_[t]);e=!0}},o(t){_=_.filter(Boolean);for(let t=0;t<_.length;t+=1)__sv.transition_out(_[t]);e=!1},d(t){t&&__sv.detach(n),__sv.destroy_each(_,t)}}}function c(t){let n,o;return n=new e({props:{x:476,y:72+40*t[9],name:"out-gate-"+t[9],output:t[7]}}),{c(){__sv.create_component(n.$$.fragment)},m(t,e){__sv.mount_component(n,t,e),o=!0},p:__sv.noop,i(t){o||(__sv.transition_in(n.$$.fragment,t),o=!0)},o(t){__sv.transition_out(n.$$.fragment,t),o=!1},d(t){__sv.destroy_component(n,t)}}}function v(t){let n,o,_,i,l,v,p=t[0].grid,f=[];for(let n=0;n<p.length;n+=1)f[n]=a(r(t,p,n));const u=t=>__sv.transition_out(f[t],1,1,(()=>{f[t]=null}));let g=t[3],m=[];for(let n=0;n<g.length;n+=1)m[n]=c(s(t,g,n));const h=t=>__sv.transition_out(m[t],1,1,(()=>{m[t]=null}));return _=new e({props:{label:"gate",x:20,y:320,name:"gate",input:t[4]}}),l=new e({props:{label:"reset",x:60,y:320,name:"reset",input:t[5]}}),{c(){for(let t=0;t<f.length;t+=1)f[t].c();n=__sv.space();for(let t=0;t<m.length;t+=1)m[t].c();o=__sv.space(),__sv.create_component(_.$$.fragment),i=__sv.space(),__sv.create_component(l.$$.fragment)},m(t,e){for(let n=0;n<f.length;n+=1)f[n].m(t,e);__sv.insert(t,n,e);for(let n=0;n<m.length;n+=1)m[n].m(t,e);__sv.insert(t,o,e),__sv.mount_component(_,t,e),__sv.insert(t,i,e),__sv.mount_component(l,t,e),v=!0},p(t,e){if(7&e){let o;for(p=t[0].grid,o=0;o<p.length;o+=1){const _=r(t,p,o);f[o]?(f[o].p(_,e),__sv.transition_in(f[o],1)):(f[o]=a(_),f[o].c(),__sv.transition_in(f[o],1),f[o].m(n.parentNode,n))}for(__sv.group_outros(),o=p.length;o<f.length;o+=1)u(o);__sv.check_outros()}if(8&e){let n;for(g=t[3],n=0;n<g.length;n+=1){const _=s(t,g,n);m[n]?(m[n].p(_,e),__sv.transition_in(m[n],1)):(m[n]=c(_),m[n].c(),__sv.transition_in(m[n],1),m[n].m(o.parentNode,o))}for(__sv.group_outros(),n=g.length;n<m.length;n+=1)h(n);__sv.check_outros()}},i(t){if(!v){for(let t=0;t<p.length;t+=1)__sv.transition_in(f[t]);for(let t=0;t<g.length;t+=1)__sv.transition_in(m[t]);__sv.transition_in(_.$$.fragment,t),__sv.transition_in(l.$$.fragment,t),v=!0}},o(t){f=f.filter(Boolean);for(let t=0;t<f.length;t+=1)__sv.transition_out(f[t]);m=m.filter(Boolean);for(let t=0;t<m.length;t+=1)__sv.transition_out(m[t]);__sv.transition_out(_.$$.fragment,t),__sv.transition_out(l.$$.fragment,t),v=!1},d(t){__sv.destroy_each(f,t),t&&__sv.detach(n),__sv.destroy_each(m,t),t&&__sv.detach(o),__sv.destroy_component(_,t),t&&__sv.detach(i),__sv.destroy_component(l,t)}}}function p(n){let e,o;return e=new t({props:{title:"SEQ",color:"var(--color-7)",light:!0,$$slots:{default:[v]},$$scope:{ctx:n}}}),{c(){__sv.create_component(e.$$.fragment)},m(t,n){__sv.mount_component(e,t,n),o=!0},p(t,[n]){const o={};65539&n&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){o||(__sv.transition_in(e.$$.fragment,t),o=!0)},o(t){__sv.transition_out(e.$$.fragment,t),o=!1},d(t){__sv.destroy_component(e,t)}}}const f=6,u=16;function g(t,e,o){let{state:_={grid:Array(f).fill(Array(u).fill(0))}}=e,s=1;const r=(t,n)=>{const e=[];for(let o=0;o<f;o++)e[o]=_.grid[o].slice(0),o===t&&(e[o][n]=1===e[o][n]?0:1);o(0,_.grid=e,_)},i=Array(f).fill(!0).map((()=>new n)),l=new n(((t,n,e)=>{o(1,s=s===u?1:s+1);for(let o=0;o<f;o++)_.grid[o][s-1]&&i[o].bang(t,n,e)})),a=new n((()=>{o(1,s=1)}));return t.$$set=t=>{"state"in t&&o(0,_=t.state)},[_,s,r,i,l,a,(t,n)=>r(t,n)]}class m extends __sv.SvelteComponent{constructor(t){super(),__sv.init(this,t,g,p,__sv.safe_not_equal,{state:0},_)}}export{m as default};
